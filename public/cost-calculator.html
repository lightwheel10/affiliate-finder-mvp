<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crew Cast Studio / Infrastructure Cost Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-void: #050505;
            --bg-surface: #0A0A0A;
            --bg-surface-highlight: #141414;
            --bg-surface-elevated: #1a1a1a;
            
            --border-subtle: rgba(255, 255, 255, 0.06);
            --border-active: rgba(255, 255, 255, 0.15);
            
            --text-primary: #EDEDED;
            --text-secondary: #888888;
            --text-tertiary: #444444;
            
            --accent-primary: #ffffff;
            --accent-glow: rgba(255, 255, 255, 0.2);
            
            --signal-green: #22c55e;
            --signal-orange: #f59e0b;
            --signal-red: #ef4444;
            
            --ease-spring: cubic-bezier(0.175, 0.885, 0.32, 1.1);
            --ease-smooth: cubic-bezier(0.16, 1, 0.3, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
        }

        body {
            background-color: var(--bg-void);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            font-size: 14px;
        }

        /* Grain Overlay */
        .noise {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.03;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        .mono { font-family: 'JetBrains Mono', monospace; letter-spacing: -0.02em; }
        .label { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary); }

        /* Layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 4rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-subtle);
        }

        .header-left h1 {
            font-size: 1.5rem;
            font-weight: 500;
            letter-spacing: -0.02em;
            margin-bottom: 0.5rem;
        }

        .header-right {
            text-align: right;
        }

        .total-display {
            font-size: 3rem;
            font-weight: 300;
            letter-spacing: -0.03em;
        }

        .total-label {
            margin-top: 0.25rem;
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        @media (max-width: 1024px) {
            .main-grid { grid-template-columns: 1fr; }
        }

        /* Section */
        .section {
            margin-bottom: 3rem;
        }

        .section-title {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border-subtle);
        }

        /* Fixed Costs Card */
        .fixed-costs {
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .fixed-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-subtle);
        }

        .fixed-row:last-child {
            border-bottom: none;
        }

        .fixed-row.total {
            margin-top: 0.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-active);
            border-bottom: none;
        }

        .service-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .service-name {
            font-weight: 500;
        }

        .service-detail {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        .service-cost {
            font-weight: 500;
        }

        /* Usage Calculator */
        .calc-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            padding: 2rem;
        }

        .input-section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-subtle);
        }

        .input-section:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .input-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .input-title {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .input-value {
            font-size: 1.5rem;
            font-weight: 500;
        }

        /* Slider */
        .slider-container {
            position: relative;
            margin: 1.5rem 0;
        }

        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 4px;
            background: var(--border-subtle);
            border-radius: 2px;
            outline: none;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #fff;
            cursor: grab;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            transition: transform 0.15s ease;
        }

        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        input[type=range]:active::-webkit-slider-thumb {
            cursor: grabbing;
            transform: scale(0.95);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.7rem;
            color: var(--text-tertiary);
        }

        /* Cost Breakdown */
        .breakdown {
            background: var(--bg-surface-highlight);
            padding: 1rem;
            margin-top: 1rem;
            font-size: 0.8rem;
        }

        .breakdown-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            color: var(--text-secondary);
        }

        .breakdown-row.highlight {
            color: var(--text-primary);
            font-weight: 500;
        }

        .breakdown-row .cost {
            color: var(--text-primary);
        }

        .breakdown-row .cost.free {
            color: var(--signal-green);
        }

        .breakdown-row .cost.overage {
            color: var(--signal-orange);
        }

        /* Per Search Breakdown */
        .per-search-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            padding: 2rem;
            margin-top: 2rem;
        }

        .api-call-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-subtle);
        }

        .api-call-row:last-child {
            border-bottom: none;
        }

        .api-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .api-icon {
            width: 28px;
            height: 28px;
            display: grid;
            place-items: center;
            background: var(--bg-surface-highlight);
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .api-name {
            font-size: 0.85rem;
        }

        .api-cost {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Summary Panel */
        .summary-panel {
            background: linear-gradient(135deg, var(--bg-surface-highlight) 0%, var(--bg-surface) 100%);
            border: 1px solid var(--border-active);
            padding: 2rem;
            position: sticky;
            top: 2rem;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-subtle);
        }

        .summary-row:last-child {
            border-bottom: none;
        }

        .summary-row.total {
            margin-top: 1rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-active);
            border-bottom: none;
            font-size: 1.1rem;
        }

        .summary-row .value {
            font-weight: 500;
        }

        .summary-row.total .value {
            font-size: 1.5rem;
        }

        /* Status Indicator */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: 1.5rem;
        }

        .status-badge.within {
            background: rgba(34, 197, 94, 0.1);
            color: var(--signal-green);
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .status-badge.overage {
            background: rgba(245, 158, 11, 0.1);
            color: var(--signal-orange);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        /* Footer */
        .footer {
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-subtle);
            display: flex;
            justify-content: space-between;
            color: var(--text-tertiary);
            font-size: 0.75rem;
        }

        /* Presets */
        .presets {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .preset-btn {
            padding: 0.5rem 1rem;
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-btn:hover {
            border-color: var(--border-active);
            color: var(--text-primary);
        }

        .preset-btn.active {
            background: var(--text-primary);
            color: var(--bg-void);
            border-color: var(--text-primary);
        }

        /* Note Box */
        .note-box {
            background: rgba(245, 158, 11, 0.05);
            border: 1px dashed rgba(245, 158, 11, 0.3);
            padding: 1rem;
            margin-top: 1rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .note-box strong {
            color: var(--signal-orange);
        }
    </style>
</head>
<body>
    <div class="noise"></div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>Infrastructure Cost Analysis</h1>
                <p class="label mono">CREW CAST STUDIO // DEC 2025</p>
            </div>
            <div class="header-right">
                <div class="total-display mono" id="grand-total">$150.00</div>
                <p class="label total-label">ESTIMATED MONTHLY</p>
            </div>
        </header>

        <!-- Presets -->
        <div class="presets">
            <button class="preset-btn active" onclick="setPreset('light')">Light User</button>
            <button class="preset-btn" onclick="setPreset('moderate')">Moderate</button>
            <button class="preset-btn" onclick="setPreset('heavy')">Heavy</button>
            <button class="preset-btn" onclick="setPreset('enterprise')">Enterprise</button>
        </div>

        <div class="main-grid">
            <!-- Left Column: Inputs -->
            <div class="left-col">
                
                <!-- Fixed Costs -->
                <div class="section">
                    <div class="section-title">Fixed Monthly Costs</div>
                    <div class="fixed-costs">
                        <div class="fixed-row">
                            <div class="service-info">
                                <span class="service-name">Apify Platform</span>
                                <span class="service-detail">$39 credits (‚àí$19 SimilarWeb rental = $20 usage)</span>
                            </div>
                            <span class="service-cost mono">$39.00</span>
                        </div>
                        <div class="fixed-row">
                            <div class="service-info">
                                <span class="service-name">Serper API</span>
                                <span class="service-detail">50,000 web searches included</span>
                            </div>
                            <span class="service-cost mono">$50.00</span>
                        </div>
                        <div class="fixed-row">
                            <div class="service-info">
                                <span class="service-name">Apollo.io</span>
                                <span class="service-detail">2,500 email lookups included</span>
                            </div>
                            <span class="service-cost mono">$59.00</span>
                        </div>
                        <div class="fixed-row total">
                            <span class="service-name">Total Fixed</span>
                            <span class="service-cost mono" style="font-size: 1.2rem;">$148.00</span>
                        </div>
                    </div>
                </div>

                <!-- Variable Usage -->
                <div class="section">
                    <div class="section-title">Monthly Usage (Variable)</div>
                    
                    <div class="calc-card">
                        <!-- Searches -->
                        <div class="input-section">
                            <div class="input-header">
                                <span class="input-title">üîç Keyword Searches</span>
                                <span class="input-value mono" id="disp-searches">50</span>
                            </div>
                            <p style="font-size: 0.8rem; color: var(--text-tertiary); margin-bottom: 1rem;">
                                Each search queries: Web (Serper) + Instagram + YouTube + TikTok (Apify)
                            </p>
                            <div class="slider-container">
                                <input type="range" id="in-searches" min="0" max="2000" step="10" value="50" oninput="update()">
                                <div class="slider-labels">
                                    <span>0</span>
                                    <span>500</span>
                                    <span>1,000</span>
                                    <span>2,000</span>
                                </div>
                            </div>
                            <div class="breakdown">
                                <div class="breakdown-row">
                                    <span>Serper (Web) ‚Äî <span id="serper-calls">50</span> calls</span>
                                    <span class="cost" id="cost-serper">INCLUDED</span>
                                </div>
                                <div class="breakdown-row">
                                    <span>Apify (Social) ‚Äî <span id="apify-search-calls">150</span> calls</span>
                                    <span class="cost" id="cost-apify-search">~$0.45</span>
                                </div>
                            </div>
                        </div>

                        <!-- Traffic Lookups -->
                        <div class="input-section">
                            <div class="input-header">
                                <span class="input-title">üìä Website Traffic Lookups</span>
                                <span class="input-value mono" id="disp-traffic">20</span>
                            </div>
                            <p style="font-size: 0.8rem; color: var(--text-tertiary); margin-bottom: 1rem;">
                                SimilarWeb data when viewing web result details ($0.05 each)
                            </p>
                            <div class="slider-container">
                                <input type="range" id="in-traffic" min="0" max="500" step="5" value="20" oninput="update()">
                                <div class="slider-labels">
                                    <span>0</span>
                                    <span>100</span>
                                    <span>250</span>
                                    <span>500</span>
                                </div>
                            </div>
                            <div class="breakdown">
                                <div class="breakdown-row">
                                    <span>SimilarWeb Scraper ‚Äî <span id="traffic-calls">20</span> domains</span>
                                    <span class="cost" id="cost-traffic">$1.00</span>
                                </div>
                            </div>
                        </div>

                        <!-- Emails -->
                        <div class="input-section">
                            <div class="input-header">
                                <span class="input-title">üìß Emails Found & Generated</span>
                                <span class="input-value mono" id="disp-emails">25</span>
                            </div>
                            <p style="font-size: 0.8rem; color: var(--text-tertiary); margin-bottom: 1rem;">
                                Apollo lookup (within 2,500) + OpenAI generation ($0.02 each)
                            </p>
                            <div class="slider-container">
                                <input type="range" id="in-emails" min="0" max="5000" step="25" value="25" oninput="update()">
                                <div class="slider-labels">
                                    <span>0</span>
                                    <span>1,000</span>
                                    <span>2,500</span>
                                    <span>5,000</span>
                                </div>
                            </div>
                            <div class="breakdown">
                                <div class="breakdown-row">
                                    <span>Apollo ‚Äî <span id="apollo-calls">25</span> emails</span>
                                    <span class="cost" id="cost-apollo">INCLUDED</span>
                                </div>
                                <div class="breakdown-row">
                                    <span>OpenAI ‚Äî <span id="openai-calls">25</span> generations</span>
                                    <span class="cost" id="cost-openai">$0.50</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Apify Budget Note -->
                    <div class="note-box">
                        <strong>‚ö†Ô∏è Apify Budget:</strong> You have $20/month for usage after SimilarWeb rental.
                        <br>Current Apify usage: <span class="mono" id="apify-usage-total">$1.45</span>
                        <span id="apify-status"></span>
                    </div>
                </div>

                <!-- Per Search Breakdown -->
                <div class="section">
                    <div class="section-title">Cost Per Single Search</div>
                    <div class="per-search-card">
                        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 1.5rem;">
                            When a user searches a keyword, these API calls are made:
                        </p>
                        <div class="api-call-row">
                            <div class="api-info">
                                <div class="api-icon">üåê</div>
                                <span class="api-name">Serper (Web/Blogs)</span>
                            </div>
                            <span class="api-cost mono">$0.001</span>
                        </div>
                        <div class="api-call-row">
                            <div class="api-info">
                                <div class="api-icon">üì∏</div>
                                <span class="api-name">Apify Instagram Search</span>
                            </div>
                            <span class="api-cost mono">~$0.002</span>
                        </div>
                        <div class="api-call-row">
                            <div class="api-info">
                                <div class="api-icon">‚ñ∂Ô∏è</div>
                                <span class="api-name">Apify YouTube Scraper</span>
                            </div>
                            <span class="api-cost mono">~$0.005</span>
                        </div>
                        <div class="api-call-row">
                            <div class="api-info">
                                <div class="api-icon">üéµ</div>
                                <span class="api-name">Apify TikTok Scraper</span>
                            </div>
                            <span class="api-cost mono">~$0.002</span>
                        </div>
                        <div class="api-call-row" style="background: var(--bg-surface-highlight); margin: 0 -2rem; padding: 1rem 2rem; border-bottom: none;">
                            <div class="api-info">
                                <div class="api-icon" style="background: var(--text-primary); color: var(--bg-void);">Œ£</div>
                                <span class="api-name" style="font-weight: 600;">Total per search</span>
                            </div>
                            <span class="api-cost mono" style="color: var(--text-primary); font-weight: 600;">~$0.01</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Summary -->
            <div class="right-col">
                <div class="summary-panel">
                    <h3 style="font-size: 1rem; margin-bottom: 1.5rem; font-weight: 500;">Monthly Cost Summary</h3>
                    
                    <div class="summary-row">
                        <span class="label">Fixed Costs</span>
                        <span class="value mono">$148.00</span>
                    </div>
                    
                    <div class="summary-row">
                        <span class="label">Serper Overage</span>
                        <span class="value mono" id="sum-serper">$0.00</span>
                    </div>
                    
                    <div class="summary-row">
                        <span class="label">Apify Overage</span>
                        <span class="value mono" id="sum-apify">$0.00</span>
                    </div>
                    
                    <div class="summary-row">
                        <span class="label">Apollo Overage</span>
                        <span class="value mono" id="sum-apollo">$0.00</span>
                    </div>
                    
                    <div class="summary-row">
                        <span class="label">OpenAI Usage</span>
                        <span class="value mono" id="sum-openai">$0.50</span>
                    </div>
                    
                    <div class="summary-row total">
                        <span>Total</span>
                        <span class="value mono" id="sum-total">$148.50</span>
                    </div>

                    <div class="status-badge within" id="status-badge">
                        <span>‚úì</span>
                        <span id="status-text">Within all included limits</span>
                    </div>

                    <!-- Usage Meters -->
                    <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border-subtle);">
                        <p class="label" style="margin-bottom: 1rem;">Credit Usage</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                <span>Apify ($20 budget)</span>
                                <span class="mono" id="meter-apify-text">$1.45 / $20</span>
                            </div>
                            <div style="height: 4px; background: var(--border-subtle); border-radius: 2px; overflow: hidden;">
                                <div id="meter-apify" style="height: 100%; width: 7%; background: var(--signal-green); transition: all 0.3s ease;"></div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                <span>Serper (50K searches)</span>
                                <span class="mono" id="meter-serper-text">50 / 50,000</span>
                            </div>
                            <div style="height: 4px; background: var(--border-subtle); border-radius: 2px; overflow: hidden;">
                                <div id="meter-serper" style="height: 100%; width: 0.1%; background: var(--signal-green); transition: all 0.3s ease;"></div>
                            </div>
                        </div>
                        
                        <div>
                            <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                <span>Apollo (2,500 emails)</span>
                                <span class="mono" id="meter-apollo-text">25 / 2,500</span>
                            </div>
                            <div style="height: 4px; background: var(--border-subtle); border-radius: 2px; overflow: hidden;">
                                <div id="meter-apollo" style="height: 100%; width: 1%; background: var(--signal-green); transition: all 0.3s ease;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <span>Prices based on API provider pricing as of December 2025</span>
            <span class="mono">SPECTRUM AI LABS √ó REVENUE WORKS LTD</span>
        </footer>
    </div>

    <script>
        // Pricing Constants
        const PRICING = {
            fixed: 148,
            
            // Apify: $39 credits, $19 goes to SimilarWeb rental, $20 for usage
            apify: {
                totalCredits: 39,
                similarWebRental: 19,
                get usageBudget() { return this.totalCredits - this.similarWebRental }, // $20
                
                // Per-call costs (approximate)
                instagramSearch: 0.002,
                youtubeSearch: 0.005,
                tiktokSearch: 0.002,
                similarWebLookup: 0.05
            },
            
            // Serper: 50K searches included
            serper: {
                included: 50000,
                perSearch: 0.001,
                overageRate: 0.001
            },
            
            // Apollo: 2,500 emails included
            apollo: {
                included: 2500,
                overageRate: 0.024
            },
            
            // OpenAI: Pay per email
            openai: {
                perEmail: 0.02
            }
        };

        // Presets
        const PRESETS = {
            light: { searches: 50, traffic: 20, emails: 25 },
            moderate: { searches: 200, traffic: 100, emails: 150 },
            heavy: { searches: 500, traffic: 250, emails: 500 },
            enterprise: { searches: 1500, traffic: 400, emails: 3000 }
        };

        // State
        let state = { ...PRESETS.light };

        // DOM refs
        const els = {
            searches: document.getElementById('in-searches'),
            traffic: document.getElementById('in-traffic'),
            emails: document.getElementById('in-emails')
        };

        function setPreset(name) {
            state = { ...PRESETS[name] };
            els.searches.value = state.searches;
            els.traffic.value = state.traffic;
            els.emails.value = state.emails;
            
            document.querySelectorAll('.preset-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            update();
        }

        function update() {
            // Read values
            state.searches = parseInt(els.searches.value);
            state.traffic = parseInt(els.traffic.value);
            state.emails = parseInt(els.emails.value);

            // === CALCULATIONS ===

            // 1. Per search: 1 Serper + 3 Apify (Insta, YT, TikTok)
            const serperCalls = state.searches;
            const apifySearchCalls = state.searches * 3; // 1 each for Insta, YT, TikTok
            const apifySearchCost = state.searches * (PRICING.apify.instagramSearch + PRICING.apify.youtubeSearch + PRICING.apify.tiktokSearch);

            // 2. Traffic lookups (SimilarWeb via Apify)
            const trafficCost = state.traffic * PRICING.apify.similarWebLookup;

            // 3. Total Apify usage
            const totalApifyUsage = apifySearchCost + trafficCost;
            const apifyOverage = Math.max(0, totalApifyUsage - PRICING.apify.usageBudget);

            // 4. Serper overage
            const serperOverage = Math.max(0, serperCalls - PRICING.serper.included) * PRICING.serper.overageRate;

            // 5. Apollo
            const apolloOverage = Math.max(0, state.emails - PRICING.apollo.included) * PRICING.apollo.overageRate;

            // 6. OpenAI (always pay)
            const openaiCost = state.emails * PRICING.openai.perEmail;

            // 7. Grand total
            const variableTotal = serperOverage + apifyOverage + apolloOverage + openaiCost;
            const grandTotal = PRICING.fixed + variableTotal;

            // === UPDATE UI ===

            // Display values
            document.getElementById('disp-searches').textContent = state.searches.toLocaleString();
            document.getElementById('disp-traffic').textContent = state.traffic.toLocaleString();
            document.getElementById('disp-emails').textContent = state.emails.toLocaleString();

            // Breakdown: Searches
            document.getElementById('serper-calls').textContent = serperCalls.toLocaleString();
            document.getElementById('apify-search-calls').textContent = apifySearchCalls.toLocaleString();
            
            const serperEl = document.getElementById('cost-serper');
            if (serperCalls <= PRICING.serper.included) {
                serperEl.textContent = 'INCLUDED';
                serperEl.className = 'cost free';
            } else {
                serperEl.textContent = '+$' + serperOverage.toFixed(2);
                serperEl.className = 'cost overage';
            }
            
            document.getElementById('cost-apify-search').textContent = '~$' + apifySearchCost.toFixed(2);

            // Breakdown: Traffic
            document.getElementById('traffic-calls').textContent = state.traffic.toLocaleString();
            document.getElementById('cost-traffic').textContent = '$' + trafficCost.toFixed(2);

            // Breakdown: Emails
            document.getElementById('apollo-calls').textContent = state.emails.toLocaleString();
            document.getElementById('openai-calls').textContent = state.emails.toLocaleString();
            
            const apolloEl = document.getElementById('cost-apollo');
            if (state.emails <= PRICING.apollo.included) {
                apolloEl.textContent = 'INCLUDED';
                apolloEl.className = 'cost free';
            } else {
                apolloEl.textContent = '+$' + apolloOverage.toFixed(2);
                apolloEl.className = 'cost overage';
            }
            
            document.getElementById('cost-openai').textContent = '$' + openaiCost.toFixed(2);

            // Apify budget note
            document.getElementById('apify-usage-total').textContent = '$' + totalApifyUsage.toFixed(2);
            const apifyStatusEl = document.getElementById('apify-status');
            if (totalApifyUsage <= PRICING.apify.usageBudget) {
                apifyStatusEl.innerHTML = ' ‚Äî <span style="color: var(--signal-green);">‚úì Within budget</span>';
            } else {
                apifyStatusEl.innerHTML = ' ‚Äî <span style="color: var(--signal-orange);">‚ö†Ô∏è +$' + apifyOverage.toFixed(2) + ' overage</span>';
            }

            // Summary panel
            document.getElementById('sum-serper').textContent = serperOverage > 0 ? '+$' + serperOverage.toFixed(2) : '$0.00';
            document.getElementById('sum-apify').textContent = apifyOverage > 0 ? '+$' + apifyOverage.toFixed(2) : '$0.00';
            document.getElementById('sum-apollo').textContent = apolloOverage > 0 ? '+$' + apolloOverage.toFixed(2) : '$0.00';
            document.getElementById('sum-openai').textContent = '$' + openaiCost.toFixed(2);
            document.getElementById('sum-total').textContent = '$' + grandTotal.toFixed(2);

            // Grand total in header
            document.getElementById('grand-total').textContent = '$' + grandTotal.toFixed(2);

            // Status badge
            const statusBadge = document.getElementById('status-badge');
            const statusText = document.getElementById('status-text');
            const hasOverage = serperOverage > 0 || apifyOverage > 0 || apolloOverage > 0;
            
            if (hasOverage) {
                statusBadge.className = 'status-badge overage';
                statusText.textContent = 'Overage charges apply';
            } else {
                statusBadge.className = 'status-badge within';
                statusText.textContent = 'Within all included limits';
            }

            // Meters
            const apifyPct = Math.min(100, (totalApifyUsage / PRICING.apify.usageBudget) * 100);
            const serperPct = Math.min(100, (serperCalls / PRICING.serper.included) * 100);
            const apolloPct = Math.min(100, (state.emails / PRICING.apollo.included) * 100);

            document.getElementById('meter-apify').style.width = apifyPct + '%';
            document.getElementById('meter-apify').style.background = apifyPct > 100 ? 'var(--signal-orange)' : apifyPct > 70 ? 'var(--signal-orange)' : 'var(--signal-green)';
            document.getElementById('meter-apify-text').textContent = '$' + totalApifyUsage.toFixed(2) + ' / $20';

            document.getElementById('meter-serper').style.width = Math.max(0.5, serperPct) + '%';
            document.getElementById('meter-serper').style.background = serperPct > 100 ? 'var(--signal-orange)' : serperPct > 70 ? 'var(--signal-orange)' : 'var(--signal-green)';
            document.getElementById('meter-serper-text').textContent = serperCalls.toLocaleString() + ' / 50,000';

            document.getElementById('meter-apollo').style.width = Math.max(0.5, apolloPct) + '%';
            document.getElementById('meter-apollo').style.background = apolloPct > 100 ? 'var(--signal-orange)' : apolloPct > 70 ? 'var(--signal-orange)' : 'var(--signal-green)';
            document.getElementById('meter-apollo-text').textContent = state.emails.toLocaleString() + ' / 2,500';
        }

        // Initialize
        update();
    </script>
</body>
</html>
